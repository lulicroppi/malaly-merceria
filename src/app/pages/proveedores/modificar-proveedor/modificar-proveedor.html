<section class="wrap">
  <div class="backrow">
    <button class="btn btn--sec btn--sm" routerLink="/proveedores">← Volver</button>
  </div>

  <h1 class="title">Modificar Proveedor</h1>

  <div class="panel" *ngIf="!loading; else cargando">
    <label class="field field--full">
      <span>Proveedor</span>
      <select [value]="selectedId" (change)="onSelect($event)">
        <option value="">— Elegí un proveedor —</option>
        <option *ngFor="let p of proveedores" [value]="p.id_proveedor">{{ p.nombre }}</option>
      </select>
    </label>

    <form class="form" [formGroup]="form" (ngSubmit)="guardar()" novalidate *ngIf="selectedId">
      <div class="grid">
        <label class="field">
          <span>Nombre *</span>
          <input type="text" formControlName="nombre">
          <small class="err" *ngIf="form.get('nombre')?.touched && form.get('nombre')?.hasError('required')">
            El <b>Nombre</b> es obligatorio.
          </small>
        </label>

        <label class="field">
          <span>Teléfono *</span>
          <input type="text" formControlName="telefono">
          <small class="err" *ngIf="form.get('telefono')?.touched && form.get('telefono')?.hasError('tel')">
            Ingresá un teléfono válido.
          </small>
        </label>

        <label class="field">
          <span>CUIT</span>
          <input type="text" formControlName="cuit" placeholder="11 dígitos">
          <small class="err" *ngIf="form.get('cuit')?.touched && form.get('cuit')?.hasError('cuit')">
            El CUIT debe tener 11 dígitos.
          </small>
        </label>

        <label class="field">
          <span>Email</span>
          <input type="email" formControlName="email">
          <small class="err" *ngIf="form.get('email')?.touched && form.get('email')?.hasError('email')">
            El email no es válido.
          </small>
        </label>

        <label class="field">
          <span>Dirección</span>
          <input type="text" formControlName="direccion">
        </label>

        <label class="field field--full">
          <span>Notas</span>
          <textarea rows="3" formControlName="notas"></textarea>
        </label>
      </div>

      <div class="actions">
        <button type="submit" class="btn" [disabled]="saving || form.pristine">Guardar cambios</button>
      </div>
    </form>
  </div>

  <ng-template #cargando>
    <div class="panel">Cargando proveedores…</div>
  </ng-template>
</section>